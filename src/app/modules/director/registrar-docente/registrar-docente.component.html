<div class="max-w-4xl mx-auto p-6 bg-white rounded-lg shadow-md">
  <!-- Mensaje de estado -->
  <div *ngIf="message" 
       class="fixed top-4 right-4 px-4 py-3 rounded shadow-lg z-50"
       [class.bg-red-100]="isError"
       [class.bg-green-100]="!isError"
       [class.text-red-700]="isError"
       [class.text-green-700]="!isError">
    {{ message }}
  </div>

  <h2 class="text-2xl font-bold text-blue-800 mb-6">
    {{ isEditing ? 'Editar Docente' : 'Registrar Docentes' }}
  </h2>

  <!-- Formulario de EDICIÓN (individual) -->
  <form *ngIf="isEditing" [formGroup]="docenteForm" (ngSubmit)="onSubmit()" class="space-y-4">
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      <!-- Email -->
      <div>
        <label class="block text-gray-700 mb-1">Email*</label>
        <input
          type="email"
          formControlName="email"
          class="w-full px-3 py-2 border rounded"
          [class.border-red-500]="docenteForm.get('email')?.invalid && (docenteForm.get('email')?.touched || formSubmitted)"
        >
        <small *ngIf="docenteForm.get('email')?.invalid && (docenteForm.get('email')?.touched || formSubmitted)" class="text-red-500">
          {{ docenteForm.get('email')?.hasError('required') ? 'Campo obligatorio' : 'Email inválido' }}
        </small>
      </div>
      <!-- Nombre -->
      <div>
        <label class="block text-gray-700 mb-1">Nombre*</label>
        <input
          type="text"
          formControlName="nombre"
          class="w-full px-3 py-2 border rounded"
          [class.border-red-500]="docenteForm.get('nombre')?.invalid && (docenteForm.get('nombre')?.touched || formSubmitted)"
        >
        <small *ngIf="docenteForm.get('nombre')?.invalid && (docenteForm.get('nombre')?.touched || formSubmitted)" class="text-red-500">
          Campo obligatorio
        </small>
      </div>

      <!-- Apellido -->
      <div>
        <label class="block text-gray-700 mb-1">Apellido*</label>
        <input
          type="text"
          formControlName="apellido"
          class="w-full px-3 py-2 border rounded"
          [class.border-red-500]="docenteForm.get('apellido')?.invalid && (docenteForm.get('apellido')?.touched || formSubmitted)"
        >
        <small *ngIf="docenteForm.get('apellido')?.invalid && (docenteForm.get('apellido')?.touched || formSubmitted)" class="text-red-500">
          Campo obligatorio
        </small>
      </div>

      <!-- Dedicación -->
      <div>
        <label class="block text-gray-700 mb-1">Dedicación*</label>
        <select
          formControlName="idDedicacion"
          class="w-full px-3 py-2 border rounded"
          [class.border-red-500]="docenteForm.get('idDedicacion')?.invalid && (docenteForm.get('idDedicacion')?.touched || formSubmitted)"
        >
          <option [ngValue]="null">Seleccionar dedicación</option>
          <option *ngFor="let d of dedicaciones" [value]="d.idDedicacion">
            {{ d.nombre }} ({{ d.horasTotales }} horas)
          </option>
        </select>
        <small *ngIf="docenteForm.get('idDedicacion')?.invalid && (docenteForm.get('idDedicacion')?.touched || formSubmitted)" class="text-red-500">
          Seleccione una dedicación
        </small>
      </div>

      <!-- Categoría -->
      <div>
        <label class="block text-gray-700 mb-1">Categoría*</label>
        <select
          formControlName="idCategoria"
          class="w-full px-3 py-2 border rounded"
          [class.border-red-500]="docenteForm.get('idCategoria')?.invalid && (docenteForm.get('idCategoria')?.touched || formSubmitted)"
        >
          <option [ngValue]="null">Seleccionar categoría</option>
          <option *ngFor="let c of categorias" [value]="c.idCategoria">
            {{ c.nombre }}
          </option>
        </select>
        <small *ngIf="docenteForm.get('idCategoria')?.invalid && (docenteForm.get('idCategoria')?.touched || formSubmitted)" class="text-red-500">
          Seleccione una categoría
        </small>
      </div>

      <!-- Horas lectivas -->
      <div>
        <label class="block text-gray-700 mb-1">Horas Máximas Lectivas*</label>
        <input
          type="number"
          formControlName="horasMaxLectivas"
          class="w-full px-3 py-2 border rounded"
          [class.border-red-500]="docenteForm.get('horasMaxLectivas')?.invalid && (docenteForm.get('horasMaxLectivas')?.touched || formSubmitted)"
        >
        <small *ngIf="docenteForm.get('horasMaxLectivas')?.invalid && (docenteForm.get('horasMaxLectivas')?.touched || formSubmitted)" class="text-red-500">
          Debe ser mayor a 0
        </small>
      </div>

      <!-- Permiso de exceso -->
      <div>
        <label class="flex items-center space-x-2">
          <input type="checkbox" formControlName="tienePermisoExceso" class="rounded">
          <span class="text-gray-700">¿Tiene permiso para exceder horas lectivas?</span>
        </label>
      </div>
    </div>

    <!-- Botones edición -->
    <div class="flex justify-end space-x-3 pt-4">
      <button
        type="button"
        (click)="router.navigate(['/director/gestionar-docentes'])"
        class="px-4 py-2 bg-gray-300 rounded hover:bg-gray-400 transition"
      >
        Cancelar
      </button>
      <button
        type="submit"
        [disabled]="isLoading"
        class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:bg-blue-300 transition"
      >
        {{ isLoading ? 'Procesando...' : 'Actualizar' }}
      </button>
    </div>
  </form>

  <!-- Formulario de REGISTRO MÚLTIPLE (solo creación) -->
  <form *ngIf="!isEditing" [formGroup]="docentesMultiplesForm" (ngSubmit)="onSubmit()" class="space-y-4">
    <div formArrayName="docentes">
      <div *ngFor="let docente of docentesArray.controls; let i = index" [formGroupName]="i" class="mb-6 p-4 border rounded-lg">
        <div class="flex justify-between items-center mb-4">
          <h3 class="text-lg font-medium">Docente {{i + 1}}</h3>
          <button 
            *ngIf="docentesArray.length > 1"
            type="button" 
            (click)="eliminarDocenteForm(i)"
            class="text-red-500 hover:text-red-700"
          >
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd" />
            </svg>
          </button>
        </div>

        <!-- Campos para cada docente -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <!-- Email -->
          <div>
            <label class="block text-gray-700 mb-1">Email*</label>
            <input
              type="email"
              formControlName="email"
              class="w-full px-3 py-2 border rounded"
              [class.border-red-500]="docente.get('email')?.invalid && (docente.get('email')?.touched || formSubmitted)"
            >
            <small *ngIf="docente.get('email')?.invalid && (docente.get('email')?.touched || formSubmitted)" class="text-red-500">
              {{ docente.get('email')?.hasError('required') ? 'Campo obligatorio' : 'Email inválido' }}
            </small>
          </div>

          <!-- Contraseña -->
          <div>
            <label class="block text-gray-700 mb-1">Contraseña*</label>
            <input
              type="password"
              formControlName="password"
              class="w-full px-3 py-2 border rounded"
              [class.border-red-500]="docente.get('password')?.invalid && (docente.get('password')?.touched || formSubmitted)"
            >
            <small *ngIf="docente.get('password')?.invalid && (docente.get('password')?.touched || formSubmitted)" class="text-red-500">
              Mínimo 6 caracteres
            </small>
          </div>

          <!-- Nombre -->
          <div>
            <label class="block text-gray-700 mb-1">Nombre*</label>
            <input
              type="text"
              formControlName="nombre"
              class="w-full px-3 py-2 border rounded"
              [class.border-red-500]="docente.get('nombre')?.invalid && (docente.get('nombre')?.touched || formSubmitted)"
            >
            <small *ngIf="docente.get('nombre')?.invalid && (docente.get('nombre')?.touched || formSubmitted)" class="text-red-500">
              Campo obligatorio
            </small>
          </div>

          <!-- Apellido -->
          <div>
            <label class="block text-gray-700 mb-1">Apellido*</label>
            <input
              type="text"
              formControlName="apellido"
              class="w-full px-3 py-2 border rounded"
              [class.border-red-500]="docente.get('apellido')?.invalid && (docente.get('apellido')?.touched || formSubmitted)"
            >
            <small *ngIf="docente.get('apellido')?.invalid && (docente.get('apellido')?.touched || formSubmitted)" class="text-red-500">
              Campo obligatorio
            </small>
          </div>

          <!-- Dedicación -->
          <div>
            <label class="block text-gray-700 mb-1">Dedicación*</label>
            <select
              formControlName="idDedicacion"
              class="w-full px-3 py-2 border rounded"
              [class.border-red-500]="docente.get('idDedicacion')?.invalid && (docente.get('idDedicacion')?.touched || formSubmitted)"
            >
              <option [ngValue]="null">Seleccionar dedicación</option>
              <option *ngFor="let d of dedicaciones" [value]="d.idDedicacion">
                {{ d.nombre }} ({{ d.horasTotales }} horas)
              </option>
            </select>
            <small *ngIf="docente.get('idDedicacion')?.invalid && (docente.get('idDedicacion')?.touched || formSubmitted)" class="text-red-500">
              Seleccione una dedicación
            </small>
          </div>

          <!-- Categoría -->
          <div>
            <label class="block text-gray-700 mb-1">Categoría*</label>
            <select
              formControlName="idCategoria"
              class="w-full px-3 py-2 border rounded"
              [class.border-red-500]="docente.get('idCategoria')?.invalid && (docente.get('idCategoria')?.touched || formSubmitted)"
            >
              <option [ngValue]="null">Seleccionar categoría</option>
              <option *ngFor="let c of categorias" [value]="c.idCategoria">
                {{ c.nombre }}
              </option>
            </select>
            <small *ngIf="docente.get('idCategoria')?.invalid && (docente.get('idCategoria')?.touched || formSubmitted)" class="text-red-500">
              Seleccione una categoría
            </small>
          </div>

          <!-- Horas Máximas -->
          <div>
            <label class="block text-gray-700 mb-1">Horas Máximas Lectivas*</label>
            <input
              type="number"
              formControlName="horasMaxLectivas"
              class="w-full px-3 py-2 border rounded"
              [class.border-red-500]="docente.get('horasMaxLectivas')?.invalid && (docente.get('horasMaxLectivas')?.touched || formSubmitted)"
            >
            <small *ngIf="docente.get('horasMaxLectivas')?.invalid && (docente.get('horasMaxLectivas')?.touched || formSubmitted)" class="text-red-500">
              Debe ser mayor a 0
            </small>
          </div>

          <!-- Permiso Exceso -->
          <div>
            <label class="flex items-center space-x-2">
              <input formControlName="tienePermisoExceso" type="checkbox" class="rounded">
              <span class="text-gray-700">Permiso para exceder horas</span>
            </label>
          </div>
        </div>
      </div>
    </div>

    <!-- Botones para registro múltiple -->
    <div class="flex flex-col sm:flex-row justify-between items-center space-y-3 sm:space-y-0 sm:space-x-3 pt-4">
      <button
        type="button"
        (click)="agregarDocenteForm()"
        class="px-4 py-2 bg-gray-200 text-gray-800 rounded hover:bg-gray-300 transition"
      >
        + Agregar otro docente
      </button>
      
      <div class="flex space-x-3">
        <button
          type="button"
          (click)="router.navigate(['/director/gestionar-docentes'])"
          class="px-4 py-2 bg-gray-300 rounded hover:bg-gray-400 transition"
        >
          Cancelar
        </button>
        <button
          type="submit"
          [disabled]="isLoading || docentesMultiplesForm.invalid"
          class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:bg-blue-300 transition"
        >
          {{ isLoading ? 'Procesando...' : 'Registrar ' + docentesArray.length + ' Docente(s)' }}
        </button>
      </div>
    </div>
  </form>
</div>